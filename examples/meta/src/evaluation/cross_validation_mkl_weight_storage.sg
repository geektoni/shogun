CSVFile f_feats("../../data/fm_train_real.dat")
CSVFile f_labels("../../data/label_train_twoclass.dat")

#![create_features]
RealFeatures features(f_feats)
CombinedFeatures comb_features()
comb_features.append_feature_obj(features)
comb_features.append_feature_obj(features)
comb_features.append_feature_obj(features)
BinaryLabels labels(f_labels)
#![create_features]

#![create_kernels]
CombinedKernel kernel()
GaussianKernel k_1(10, 0.1)
GaussianKernel k_2(10, 1)
GaussianKernel k_3(10, 2)
kernel.append_kernel(k_1)
kernel.append_kernel(k_2)
kernel.append_kernel(k_3)
#![create_kernels]

#![create_classifier]
LibSVM libsvm()
MKLClassification svm(libsvm)
svm.set_interleaved_optimization_enabled(False)
svm.set_kernel(kernel)
#![create_classifier]

#![create_cross_validation]
StratifiedCrossValidationSplitting splitting_strategy(labels, 5)
ContingencyTableEvaluation evaluation_criterium(ACCURACY)
CrossValidation cross(svm, comb_features, labels, splitting_strategy, evaluation_criterium)
cross.set_autolock(false)
cross.set_num_runs(3)
#![create_cross_validation]

#![create_observer]
ParameterObserverCV mkl_obs(true)
cross.subscribe_to_parameters(mkl_obs)
#[!create_observer]

#![evaluate]
CrossValidationResult result()
result = result.obtain_from_generic(cross.evaluate())
result.print_result()
#![evaluate]